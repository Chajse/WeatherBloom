<div class="h-screen flex justify-center items-center relative">
  <div style="background-image: url(../assets/images/bsky.jpg); background-repeat: no-repeat; background-position: center; background-size: cover; filter: blur(3px) brightness(0.8);" class="absolute w-full h-screen -z-50"></div>
  <div class="w-full">
    <div class="w-[50%] mx-auto mb-5 flex items-center">
      <form class="suggestion-container w-full" [formGroup]="searchForm">
        <label for="simple-search" class="sr-only">Search </label>
        <div class="relative w-full">
          <div
            class="flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"
          >
            <svg
              class="w-5 h-5 text-gray-500 dark:text-gray-400"
              fill="currentColor"
              viewBox="0 0 20 20"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                clip-rule="evenodd"
              ></path>
            </svg>
          </div>
          <input
            (focus)="onInputFocus()"
            (blur)="onInputBlur()"
            formControlName="city"
            type="text"
            id="input-group-1"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:border-gray-500 focus:ring-0 block w-full pl-10 p-2.5"
            placeholder="Search your City"
          />
          <ul
            *ngIf="
              inputFocused &&
              (suggestions?.length > 0 ||
                showNotFoundMessage ||
                loadingSuggestions)
            "
            class="max-h-[50vh] overflow-auto absolute b-0 z-10 rounded-lg p-1.5 text-sm text-gray-500 noshadow shadow-lg w-full bg-slate-50 border-gray-300 border"
          >
            <ng-container *ngIf="!loadingSuggestions; else loadingDisplay">
              <ng-container
                *ngIf="suggestions?.length !== 0; else locationNotFound"
              >
                <li
                  *ngFor="let location of suggestions"
                  class="py-1.5 z-50 px-2 border-b cursor-pointer hover:bg-sky-100 hover:shadow-lg border-gray-300 last:border-b-0"
                  (mousedown)="onSuggestionMouseDown()"
                  (mouseup)="onSuggestionMouseUp()"
                  (click)="onSuggestionClick(location)"
                >
                  <div class="flex justify-between my-auto gap-4">
                    <div class="my-auto">
                      <p class="font-semibold text-xs">
                        {{ location.country }} - {{ location.name }}
                      </p>
                      <p
                        matTooltip="State: {{ location.state }}"
                        class="text-[0.70rem] truncate w-[20vh]"
                      >
                        {{ location.state }}
                      </p>
                    </div>
                    <div
                      class="text-[0.60rem] text-center my-auto -space-y-2 w-100%"
                    >
                      <p
                        matTooltip="Latitude: {{ location.lat }}"
                        class="truncate"
                      >
                        Lat: {{ location.lat }}
                      </p>
                      <p
                        matTooltip="Longitude: {{ location.lon }}"
                        class="truncate"
                      >
                        Lon: {{ location.lon }}
                      </p>
                    </div>
                  </div>
                </li>
              </ng-container>
            </ng-container>
          </ul>
        </div>
      </form>

      <button
        [matMenuTriggerFor]="settings"
        class="p-2.5 ml-2 text-sm font-medium text-white bg-[#2f2079] rounded-lg hover:bg-[#432eac] focus:outline-none focus:ring-0"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-bolt hover:animate-spin"
        >
          <path
            d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"
          />
          <circle cx="12" cy="12" r="4" />
        </svg>
      </button>
      <mat-menu #settings xPosition="after" yPosition="above">
        <div class="menu">
          <ul>
            <li class="font-black">Temperature</li>
            <li>
              <button
                class="text-black font-normal"
                (click)="changeMetricSystem('&units=standard')"
              >
                Measure by Kelvin
              </button>
            </li>
            <li>
              <button
                class="text-black font-normal"
                (click)="changeMetricSystem('&units=imperial')"
              >
                Measure by Fahrenheit
              </button>
            </li>
            <li>
              <button
                class="text-black font-normal"
                (click)="changeMetricSystem('&units=metric')"
              >
                Measure by Celsius
              </button>
            </li>
          </ul>
        </div>
      </mat-menu>
    </div>

    <div class="w-full flex items-center overflow-hidden">
      <div class="w-[75%] lg:px-40 justify-center container mx-auto">
        <div class="flex flex-wrap w-full lg:w-auto">
          <div class="w-full lg:w-1/2 flex rounded-lg bg-auto">
            <div
              class="rounded-lg py-6 backdrop-blur-md pl-8 pr-32 w-full bg-[#2f2079] text-white"
            >
              <div class="mb-20">
                <h2 class="font-bold text-3xl leading-none pb-1">
                  {{ currentDate | date : "EEEE" }}
                </h2>
                <h3 class="leading-none pb-2 pl-1 text-xs">
                  {{ currentDate | date : " MMMM d, y" }}
                </h3>
                <p class="flex aling-center opacity-75">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="24px"
                    viewBox="0 -960 960 960"
                    width="24px"
                    fill="#f05252"
                  >
                    <path
                      d="M480-480q33 0 56.5-23.5T560-560q0-33-23.5-56.5T480-640q-33 0-56.5 23.5T400-560q0 33 23.5 56.5T480-480Zm0 294q122-112 181-203.5T720-552q0-109-69.5-178.5T480-800q-101 0-170.5 69.5T240-552q0 71 59 162.5T480-186Zm0 106Q319-217 239.5-334.5T160-552q0-150 96.5-239T480-880q127 0 223.5 89T800-552q0 100-79.5 217.5T480-80Zm0-480Z"
                    />
                  </svg>

                  {{ weatherData?.name }}, {{ weatherData?.sys.country }}
                </p>
              </div>
              <div>
                <img
                  [src]="
                    'https://openweathermap.org/img/wn/' +
                    weatherData?.weather[0].icon +
                    '@2x.png'
                  "
                  class="-ms-3 -mb-5 h-40"
                />
                <strong class="leading-none text-6xl block font-weight-bolder">
                  {{ weatherData?.main.temp }}{{
                    getMetricSymbol(metricSystem)
                  }}</strong
                >
                <b class="text-2xl block font-bold">{{
                  weatherData?.weather[0].main
                }}</b>
              </div>
            </div>
          </div>

          <div
            *ngIf="weatherData"
            class="w-full lg:w-1/2 flex items-center ml-0"
          >
            <div class="bg-gray-800 text-white p-4 lg:rounded-r-lg w-full">
              <!-- switch -->
              <div class="flex justify-between items-center mb-2">
                <div class="text-white tracking-widest text-base">
                  Information
                </div>
                <div class="view-options rounded-md">
                  <button
                    (click)="toggleAdvanced()"
                    class="transition-colors duration-300 ease-in-out rounded-s-md"
                    [ngClass]="{ 'bg-[var(--yellow-1)]': !showAdvanced }"
                  >
                    Basic
                  </button>
                  <button
                    (click)="toggleAdvanced()"
                    class="transition-colors duration-300 ease-in-out rounded-e-md"
                    [ngClass]="{ 'bg-[var(--yellow-1)]': showAdvanced }"
                  >
                    Advanced
                  </button>
                </div>
              </div>

              <!-- basic view -->
              <div
                *ngIf="!showAdvanced"
                class="grid grid-cols-2 w-full gap-5 max-h-[336px] h-[336px]"
              >
                <div
                  class="flex flex-col justify-center items-center col-span-1 bg-gray-100 text-black rounded-lg pb-4"
                >
                  <div class="text-center">
                    <strong class="text-xl">
                      {{ weatherData.main.temp_min }}{{
                        getMetricSymbol(metricSystem)
                      }}</strong
                    >
                  </div>
                  <div
                    class="text-center pt-2 flex justify-center items-center"
                  >
                    <img
                      src="../assets/images/temperatureDark.png"
                      class="w-8"
                    />
                    <span>Min</span>
                  </div>
                </div>

                <div
                  class="flex flex-col justify-center items-center col-span-1 bg-gray-100 text-black rounded-lg pb-4"
                >
                  <div class="text-center">
                    <strong class="text-xl">
                      {{ weatherData.main.temp_max }}{{
                        getMetricSymbol(metricSystem)
                      }}</strong
                    >
                  </div>
                  <div
                    class="text-center pt-2 flex justify-center items-center"
                  >
                    <img src="../assets/images/hot.png" class="w-8" />
                    <span>Max</span>
                  </div>
                </div>

                <div
                  class="flex flex-col justify-center items-center col-span-1 bg-gray-100 text-black rounded-lg pb-4"
                >
                  <div class="text-center">
                    <strong class="text-xl"
                      >{{ weatherData.main.humidity }}%</strong
                    >
                  </div>
                  <div
                    class="text-center pt-2 flex justify-center items-center"
                  >
                    <img src="../assets/images/humid.png" class="w-8" />
                    <span>Humidity</span>
                  </div>
                </div>

                <div
                  class="flex flex-col justify-center items-center col-span-1 bg-gray-100 text-black rounded-lg pb-4"
                >
                  <div class="text-center">
                    <strong class="text-xl">
                      {{ weatherData.clouds.all }}%</strong
                    >
                  </div>
                  <div
                    class="text-center pt-2 flex justify-center items-center"
                  >
                    <img src="../assets/images/clouds.png" class="w-8" />
                    <span>Cloud</span>
                  </div>
                </div>
              </div>

              <!-- advance view -->
              <div
                *ngIf="showAdvanced"
                class="grid grid-cols-2 w-full gap-5 max-h-[336px] h-[336px]"
              >
                <div
                  class="flex flex-col justify-center items-center col-span-1 bg-gray-100 text-black rounded-lg pb-4"
                >
                  <div class="text-center">
                    <strong class="text-xl">
                      {{ weatherData.main.sea_level }}m</strong
                    >
                  </div>
                  <div
                    class="text-center pt-2 flex justify-center items-center"
                  >
                    <img src="../assets/images/sea-level.png" class="w-8" />
                    <span>Sea Level</span>
                  </div>
                </div>

                <div
                  class="flex flex-col justify-center items-center col-span-1 bg-gray-100 text-black rounded-lg pb-4"
                >
                  <div class="text-center">
                    <strong class="text-xl">
                      {{weatherData.rain?.['1h'] || 0}}mm/h</strong
                    >
                  </div>
                  <div
                    class="text-center pt-2 flex justify-center items-center"
                  >
                    <img src="../assets/images/raining.png" class="w-8" />
                    <span>Hourly Rainfall</span>
                  </div>
                </div>

                <div
                  class="flex flex-col justify-center items-center col-span-1 bg-gray-100 text-black rounded-lg pb-4"
                >
                  <div class="text-center">
                    <strong class="text-xl"
                      >{{ weatherData.wind.speed }}km/h</strong
                    >
                  </div>
                  <div
                    class="text-center pt-2 flex justify-center items-center"
                  >
                    <img src="../assets/images/wind.png" class="w-8" />
                    <span>Wind Speed</span>
                  </div>
                </div>

                <div
                  class="flex flex-col justify-center items-center col-span-1 bg-gray-100 text-black rounded-lg pb-4"
                >
                  <div class="text-center">
                    <strong class="text-xl">
                      {{ weatherData.wind.deg }}°{{
                        getMetricSymbol(metricSystem)
                      }}
                    </strong>
                  </div>
                  <div
                    class="text-center pt-2 flex justify-center items-center"
                  >
                    <img
                      src="../assets/images/wind-direction.png"
                      class="w-8"
                    />
                    <span>Wind</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #loadingDisplay> loading... </ng-template>

<ng-template #locationNotFound> loading... </ng-template>

<router-outlet></router-outlet>

<!-- search -->
<!-- <div class="relative mb-6">
  <div
    class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none"
  >
    <svg
      class="w-6 h-6 text-gray-800 dark:text-white"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      fill="none"
      viewBox="0 0 24 24"
    >
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-width="2"
        d="m21 21-3.5-3.5M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"
      />
    </svg>
  </div>
  <form [formGroup]="searchForm" class="suggestion-container">
    <input
      (focus)="onInputFocus()"
      (blur)="onInputBlur()"
      formControlName="city"
      type="text"
      id="input-group-1"
      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
      placeholder="Search your City"
    />
    <ul
      *ngIf="
        inputFocused &&
        (suggestions?.length > 0 || showNotFoundMessage || loadingSuggestions)
      "
      class="max-h-[50vh] overflow-auto absolute b-0 z-10 rounded-lg p-1.5 text-sm text-gray-500 noshadow shadow-lg w-full bg-slate-50 border-gray-300 border"
    >
      <ng-container *ngIf="!loadingSuggestions; else loadingDisplay">
        <ng-container *ngIf="suggestions?.length !== 0; else locationNotFound">
          <li
            *ngFor="let location of suggestions"
            class="py-1.5 z-50 px-2 border-b cursor-pointer hover:bg-sky-100 hover:shadow-lg border-gray-300 last:border-b-0"
            (mousedown)="onSuggestionMouseDown()"
            (mouseup)="onSuggestionMouseUp()"
            (click)="onSuggestionClick(location)"
          >
            <div class="flex justify-between my-auto gap-4">
              <div class="my-auto">
                <p class="font-semibold text-xs">
                  {{ location.country }} - {{ location.name }}
                </p>
                <p
                  matTooltip="State: {{ location.state }}"
                  class="text-[0.70rem] truncate w-[20vh]"
                >
                  {{ location.state }}
                </p>
              </div>
              <div class="text-[0.60rem] text-center my-auto -space-y-2 w-100%">
                <p matTooltip="Latitude: {{ location.lat }}" class="truncate">
                  Lat: {{ location.lat }}
                </p>
                <p matTooltip="Longitude: {{ location.lon }}" class="truncate">
                  Lon: {{ location.lon }}
                </p>
              </div>
            </div>
          </li>
        </ng-container>
      </ng-container>
    </ul>
  </form>
</div> -->

<!-- main data -->
<!-- <div class="container">
  <div class="upper-data">
    <div class="weather-data">
      <button [matMenuTriggerFor]="settings">
        <div class="boltIcon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-bolt"
          >
            <path
              d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"
            />
            <circle cx="12" cy="12" r="4" />
          </svg>
        </div>
      </button>
      <mat-menu #settings xPosition="after" yPosition="above">
        <div class="menu">
          <ul>
            <li class="font-black">Temperature</li>
            <li>
              <button
                class="text-black font-normal"
                (click)="changeMetricSystem('&units=standard')"
              >
                Measure by Kelvin
              </button>
            </li>
            <li>
              <button
                class="text-black font-normal"
                (click)="changeMetricSystem('&units=imperial')"
              >
                Measure by Fahrenheit
              </button>
            </li>
            <li>
              <button
                class="text-black font-normal"
                (click)="changeMetricSystem('&units=metric')"
              >
                Measure by Celsius
              </button>
            </li>
          </ul>
        </div>
      </mat-menu>
      <div *ngIf="weatherData">
        <div class="location">{{ weatherData.name }}</div>

        <div class="temperature">{{ weatherData.weather[0].main }}</div>
      </div>
    </div>
  </div>

  <div class="lower-data">
    <div class="info-container">
      <div class="more-info-label">Information</div>
      <div class="view-options">
        <button
          (click)="toggleAdvanced()"
          class="rounded-s-md"
          [ngClass]="{ 'bg-[var(--yellow-1)]': !showAdvanced }"
        >
          Basic
        </button>
        <button
          (click)="toggleAdvanced()"
          class="rounded-e-md"
          [ngClass]="{ 'bg-[var(--yellow-1)]': showAdvanced }"
        >
          Advanced
        </button>
      </div>
    </div>
    <div *ngIf="weatherData" class="more-info-container">
      <div *ngIf="!showAdvanced" class="grid grid-cols-2 gap-10">
        <div class="info-block grid-cols-1">
          <div class="info-block-label">
            <img src="../assets/images/temperatureDark.png" />
            <span>min</span>
          </div>
          <div class="info-block-value">
            {{ weatherData.main.temp_min }}°{{ getMetricSymbol(metricSystem) }}
          </div>
        </div>
        <div class="info-block grid-cols-1">
          <div class="info-block-label">
            <img src="../assets/images/hot.png" />
            <span>max</span>
          </div>
          <div class="info-block-value">
            {{ weatherData.main.temp_max }}°{{ getMetricSymbol(metricSystem) }}
          </div>
        </div>

        <div class="info-block grid-cols-1">
          <div class="info-block-label">
            <img src="../assets/images/humid.png" />
            <span>humidity</span>
          </div>
          <div class="info-block-value">{{ weatherData.main.humidity }}%</div>
        </div>

        <div class="info-block grid-cols-1">
          <div class="info-block-label">
            <img src="../assets/images/clouds.png" />
            <span>cloud</span>
          </div>
          <div class="info-block-value text-nowrap">
            {{ weatherData.clouds.all }}%
          </div>
        </div>
      </div>

      <div *ngIf="showAdvanced" class="grid grid-cols-2 gap-10">
        <div class="info-block grid-cols-1">
          <div class="info-block-label">
            <img src="../assets/images/sea-level.png" />
            <span>sea level</span>
          </div>
          <div class="info-block-value">{{ weatherData.main.sea_level }}m</div>
        </div>
        <div class="info-block grid-cols-1">
          <div class="info-block-label">
            <img src="../assets/images/raining.png" />
            <span class="text-center">hourly rainfall</span>
          </div>
          <div class="info-block-value">
            {{weatherData.rain?.['1h'] || 0}}mm/h
          </div>
        </div>

        <div class="info-block grid-cols-1">
          <div class="info-block-label">
            <img src="../assets/images/wind.png" />
            <span class="text-center">wind speed</span>
          </div>
          <div class="info-block-value">{{ weatherData.wind.speed }}km/h</div>
        </div>

        <div class="info-block grid-cols-1">
          <div class="info-block-label">
            <img src="../assets/images/wind-direction.png" />
            <span>wind</span>
          </div>
          <div class="info-block-value">
            {{ weatherData.wind.deg }}°{{ getMetricSymbol(metricSystem) }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div> -->
